local Library = {}

function Library:CreateWindow(config)
    -- Các tham số mặc định nếu không có
    local title = config.Title or "Window"
    local center = config.Center or true
    local autoShow = config.AutoShow or true
    local tabPadding = config.TabPadding or 7
    local menuFadeTime = config.MenuFadeTime or 0.2
    local size = config.Size or UDim2.new(0, 420, 0, 360)

    local Window = {}

    -- Tạo ScreenGui
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = title

    -- Tạo MainFrame
    local MainFrame = Instance.new("Frame")
    MainFrame.Size = size
    MainFrame.Position = center and UDim2.new(0.5, -size.X.Offset / 2, 0.5, -size.Y.Offset / 2) or UDim2.new(0, 0, 0, 0)
    MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    MainFrame.Parent = ScreenGui
    MainFrame.ClipsDescendants = true

    -- Hiệu ứng bo góc
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 12)
    UICorner.Parent = MainFrame

    -- Đổ bóng
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = Color3.fromRGB(0, 255, 0)
    UIStroke.Thickness = 2
    UIStroke.Parent = MainFrame

    -- Tạo Title Bar
    local TitleBar = Instance.new("TextLabel")
    TitleBar.Size = UDim2.new(1, 0, 0.1, 0)
    TitleBar.Text = title
    TitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    TitleBar.TextColor3 = Color3.fromRGB(255, 255, 255)
    TitleBar.Font = Enum.Font.GothamBold
    TitleBar.TextScaled = true
    TitleBar.Parent = MainFrame

    -- Tạo Sidebar
    local Sidebar = Instance.new("Frame")
    Sidebar.Size = UDim2.new(0.3, 0, 0.9, 0)
    Sidebar.Position = UDim2.new(0, 0, 0.1, 0)
    Sidebar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    Sidebar.Parent = MainFrame
    local SidebarCorner = Instance.new("UICorner")
    SidebarCorner.CornerRadius = UDim.new(0, 10)
    SidebarCorner.Parent = Sidebar

    -- Tạo Content Frame
    local Content = Instance.new("Frame")
    Content.Size = UDim2.new(0.7, 0, 0.9, 0)
    Content.Position = UDim2.new(0.3, 0, 0.1, 0)
    Content.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Content.Parent = MainFrame
    local ContentCorner = Instance.new("UICorner")
    ContentCorner.CornerRadius = UDim.new(0, 10)
    ContentCorner.Parent = Content

    -- Tab Padding (Khoảng cách giữa các tab)
    local UIListLayout = Instance.new("UIListLayout")
    UIListLayout.Padding = UDim.new(0, tabPadding)
    UIListLayout.Parent = Sidebar

    -- Hiển thị window nếu AutoShow là true
    if autoShow then
        ScreenGui.Parent = game:GetService("CoreGui")
    end

    -- Tính năng di chuyển cửa sổ
    local dragging = false
    local dragStart = Vector2.new()
    local startPosition = UDim2.new()

    TitleBar.MouseButton1Down:Connect(function(x, y)
        dragging = true
        dragStart = Vector2.new(x, y)
        startPosition = MainFrame.Position
    end)

    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if dragging then
            local delta = Vector2.new(input.Position.X - dragStart.X, input.Position.Y - dragStart.Y)
            MainFrame.Position = UDim2.new(startPosition.X.Scale, startPosition.X.Offset + delta.X, startPosition.Y.Scale, startPosition.Y.Offset + delta.Y)
        end
    end)

    game:GetService("UserInputService").InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)

    -- Thêm fade effect cho menu (khi ẩn hoặc hiện các tab)
    local function fadeMenu()
        local menuTween = game:GetService("TweenService"):Create(Sidebar, TweenInfo.new(menuFadeTime), {BackgroundTransparency = 0.5})
        menuTween:Play()
    end

    fadeMenu()

    -- Trả về Window
    Window.ScreenGui = ScreenGui
    Window.MainFrame = MainFrame
    Window.Content = Content

    return Window
end

return Library
